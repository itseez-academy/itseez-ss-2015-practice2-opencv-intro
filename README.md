# Практика 2. Базовые примитивы и основные операции обработки изображений в библиотеке OpenCV

[![Build Status](https://travis-ci.org/Itseez-NNSU-SummerSchool2015/practice2-opencv-intro.svg)](https://travis-ci.org/Itseez-NNSU-SummerSchool2015/practice2-opencv-intro)


Проект представляет собой инфраструктуру для освоения основ работы 
с библиотекой OpenCV:
  - Загрузка/сохранение изображений (базовые примитивы и операции 
    модуля ```opencv_core```).
  - Обработка изображений с помощью простеших фильтров библиотеки 
    (операции модуля ```opencv_imgproc```).
  - Разработка простейшего интерфейса средствами библиотеки (базовые 
    операции модуля ```opencv_highgui```).

## Общая структура проекта

Структура проекта:
  - `3rdparty` - библиотека gtest.
  - `include` - директория для размещения заголовочных файлов.
  - `samples` - директория для размещения примеров использования.
  - `src` - директория с исходными кодами.
  - `test` - директория с тестами.
  - `testdata``` - директория с данными для тестов.
  - `.gitignore` - перечень расширений файлов, которые не выкладываются 
    в проект.
  - `.travis.yml` - конфигурационный файл для системы автоматического 
    тестирования Travis-CI.
  - `CMakeLists.txt` - общий файл для сборки проекта с помощью CMake.
  - `README.md` - информация о проекте, которую вы сейчас читаете.

В шаблонном проекте имеются следующие модули:
  - Модуль вспомогательных функций (`./include/auxiliaries.hpp`, 
    `./src/auxiliaries.hpp`), в частности, функция обработки аргументов 
	командной строки.
  - Модуль, содержащий объявление и реализацию функций загрузки, обработки 
    и отображения изображений (`./include/img_proc.hpp`, `./src/img_proc.hpp`).
  - Примеры тестов (`aux_test.cpp`).
  - Пример приложения, демонстрирующего применение медианного фильтра 
    (`sample_template.cpp`).

## Цели и задачи

__Цель данной работы__ - изучить базовые примитивы модуля `opencv_core` 
и простейшие операции обработки изображений модуля `opencv_imgproc`, научиться 
разрабатывать интерфейс средствами модуля `opencv_highgui` на примере задачи 
определения ребер на изображении.

Для этого необходимо решить следующие __задачи__:
  1. Изучить базовые методы класса `Mat` (модуль `opencv_core`), который 
     применяется для представления изображений.
  2. Рассмотреть основные операции работы с изображениями:
     1. Создание изображения (с помощью конструкторов или метода `create` 
	    класса `Mat`).
	 2. Загрузка изображения (функция `imread`).
	 3. Сохранение изображения (функция `imwrite`).
	 4. Отображение изображения (функции `imshow`, `waitKey`).
	 5. Копирование изображения (метод `copyTo` класса `Mat`).
	 6. Методы фильтрации (размытие, сглаживание и др.).
	 7. Преобразование изображения в различные цветовые пространства 
	    (функция `cvtColor`).
  3. Изучить и реализовать с использованием OpenCV различные способы 
     выделения контуров на изображении:
     1. Бинаризация изображения (функция `threshold`) + поиск контуров 
	    (функция `findContours`). Примечание: для отображения контуров 
		следует использовать функцию `drawContours`.
	 2. Морфологический градиент (функция `morphologyEx`).
	 3. Оператор Собеля (функция `Sobel`).
	 4. Оператор Лапласа (функция `Laplacian`).
	 5. Детектор ребер Канни (функция `Canny`). Примечание: перед применением 
	    фильтра Канни потребуется выполнить фильтрацию и преобразование 
		изображения в оттенки серого.
  4. Разработать графический интерфейс, удовлетворяющий следующим требованиям:
     1. Отображение исходного изображения.
	 2. Отображение изображения, на котором отображены контуры.
	 3. Наличие набора переключателей (кнопок) для применения различных 
	    методов выделения контуров.

## Инструкция по выполнению работы

  1. Создать аккаунт на [github.com](https://github.com), если такой 
     отсутствует. Для определенности обозначим аккаунт `github-account`.
  
  2. Сделать fork репозитория 
     <https://github.com/Itseez-NNSU-SummerSchool2015/practice2-opencv-intro> 
	 (в терминологии Git upstream-репозиторий) к себе в организацию с названием 
	 `github-account`. В результате будет создана копию репозитория с названием 
	 <https://github.com/github-account/practice2-opencv-intro> 
	 (origin-репозиторий).
  
  3. Клонировать репозиторий [origin][origin] к себе на локальный компьютер, 
     воспользовавшись следующей командой:
  
  ```
  $ git clone https://github.com/github-account/practice2-opencv-intro
  ```
  
  4. Настроить upstream-репозиторий:
  
  ```
  $ git remote add upstream https://github.com/Itseez-NNSU-SummerSchool2015/practice2-opencv-intro
  ```
  
  5. Настроить имя пользователя, из под которого будут выполняться 
     все операции с репозиторией Git:
  
  ```
  $ git config --global user.name "github-account"
  ```
  
  6. Создать ветку `find-contours-implementation` и перейти в нее:
  
  ```
  $ git checkout -b find-contours-implementation
  ```
  
  7. В ветку `find-contours-implementation` поместить реализации различных 
     методов поиска контуров, снабдив весь разработанный код необходимым 
	 набором тестов. В качестве шаблона необходимо использовать модуль 
	 `img_proc`. Модуль должен быть расширен различными реализациями методов
	 поиска контуров на изображении средствами OpenCV. Для начала имеет смысл 
	 сосредоточиться на реализации одного метода из перечисленных ниже.
	 
	 1. Бинаризация изображения (функция `threshold`) + поиск контуров 
	    (функция `findContours`). Примечание: для отображения контуров 
		следует использовать функцию `drawContours`.
	 2. Морфологический градиент (функция `morphologyEx`).
	 3. Оператор Собеля (функция `Sobel`).
	 4. Оператор Лапласа (функция `Laplacian`).
	 5. Детектор ребер Канни (функция `Canny`). Примечание: перед применением 
	    фильтра Канни потребуется выполнить фильтрацию и преобразование 
		изображения в оттенки серого.

  8. Создать ветку `gui-implementation` и перейти в нее:
  
  ```
  $ git checkout -b gui-implementation
  ```
  
  9. В ветку `gui-implementation` поместить разработанную интерфейсную часть. 
     Примечание: по существу необходимо разработать пример использования 
	 реализованного метода поиска контуров. Далее приведены возможные
	 варианты реализации интерфейса в порядке их усложнения с точки зрения 
	 программной реализации.
	 
	 1. Отобразите одновременно в одном окне исходное изображение и изображение
	    с выделенными контурами. Примечание: пример такого интерфейса уже 
		имеется в проекте.
	 2. Добавьте внизу окна виртуальные кнопки (на самом деле одноцветные 
	    изображения), каждая из которых соответствует вызову определенного 
		метода выделения контуров изображении. Не забудьте на них добавить 
		соответствующие надписи. Обеспечьте возможность обновления результата
		выделения контуров при нажатии на каждую из кнопок. *Указание*: 
		следует использовать возможность создания обработчика события нажатия
		на кнопку, отслеживая положение курсора в каждый текущий момент 
		времени, чтобы определить, какой метод поиска контуров необходимо 
		вызвать.
	 
	 **Примечание:** примеров использования библиотеки может быть в проекте много. 
	 Когда разработан какой-то метод стоит его снабдить простым примером
	 использования. Если задача выделения контуров решена уже несколькими
	 способами, то можно подумать над усложненными вариантом интерфеса, который
	 объединяет возможности использования различных способов выделения контуров.
  
  10. После получения каждой стабильной версии не забывайте проверять 
      работоспособность тестов и выкладывать изменения в ветку.  
  
  ```
  $ git status # Получить список текущих изменений
  
  $ git add [<file_name>] # Добавить файл в репозиторий
  # <file_name> - название файла для добавления в commit
    если вместо имени указан символ *, то будут добавлены все новые файлы, 
    расширение которых не указано в .gitignore
  
  $ git commit [-m "<message_to_commit>"] [-a]
  # [-a] - автоматически добавляет изменения для существующих на сервере файлов
    без выполнения команды git add
  # [--amend] - перезаписывает последний коммит (используется, если не забыты
    изменения)
  
  $ git push origin find-contours-implementation # или gui-implementation
  ```
  
  11. Не забудьте сделать Pull Request, чтобы проверить работоспособность 
      тестов на Travis-CI и позволить преподавателям сделать ревью Вашего кода.
  
  **Примечание:** подробная инструкция по сборке проекта, запуска тестов была 
  описана в [практической работе по освоению инструментов разработки]
  (https://github.com/Itseez-NNSU-SummerSchool2015/practice1-devtools).
  При сборке проекта в командной строке `cmake` необходимо указать 
  опцию `-DOpenCV_DIR="path-to-OpenCVConfig.cmake"`, чтобы подключить 
  библиотеку OpenCV.
  
  12. При наличии времени можно организовать обработку видео и вместо одного 
      изображения обрабатывать и отображать последовательно идущие кадры 
	  потока.
  
<!-- LINKS -->

[origin]: https://github.com/github-account/practice2-opencv-intro
